apiVersion: v1beta1
kind: Kustomization

namespace: exoscale-provider-system
namePrefix: exoscale-provider-

resources:
- ../crds/exoscale_v1alpha1_exoscaleclusterproviderspec.yaml
- ../crds/exoscale_v1alpha1_exoscalemachineproviderspec.yaml
- ../rbac/rbac_role.yaml
- ../rbac/rbac_role_binding.yaml
- ../manager/manager.yaml

secretGenerator:
- commands:
    api-key: printf $EXOSCALE_API_KEY
    compute-endpoint: printf $EXOSCALE_COMPUTE_ENDPOINT
    secret-key: printf $EXOSCALE_SECRET_KEY
  name: controller-secrets
  type: Opaque

patchesStrategicMerge:
- manager_image_patch.yaml

patchesJson6902:
- target:
    group: rbac.authorization.k8s.io
    version: v1
    kind: ClusterRole
    name: manager-role
  path: rbac_role_cluster_patch.yaml
